#include "songs.h"
#include "buzzer.h"
#include "libTimer.h"
#include <msp430.h>

void delay_ms(unsigned int ms){
  unsigned int i;
  for (i = 0; i<= ms; i++){
       __delay_cycles(500);
    }  //Built-in function that suspends the execution for 500 cicles
}

void delay_us(unsigned int us){
  unsigned int i;
  for (i = 0; i<= us/2; i++){
     __delay_cycles(1);
  }
}

void beep(unsigned int note, unsigned int duration){
  int i;
  long delay = (long)(10000/note);  //This is the semiperiod of each note.
  long time = (long)((duration*100)/(delay*2));  //This is how much time we need to spend on the note .
  for (i=0;i<time;i++)
    {
      P2OUT |= BIT6;
       buzzer_set_period(note);//Set P1.2...
       delay_us(delay);
       P2OUT &= ~BIT6;    //...then reset it...
       delay_us(delay);   //...for the other semiperiod.
    }
    delay_ms(2000000); //Add a little delay to separate the single notes
}

void play(){
   beep(b,50000);
   beep(d,1);
   beep(a,50000);

   beep(g,1);
   beep(a,1);
   
    beep(b,50000);
    beep(d,1);
    beep(a,50000);

     delay_ms(20);
   
    beep(b,50000);
    beep(d,1);
    beep(asix,50000);

    beep(gsix,1);
    beep(d,5000);

    beep(csix,1);
    beep(b,1);
    beep(a,1);


}
